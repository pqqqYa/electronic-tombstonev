## 1 计算机系统的层次结构

### 1.1 计算机系统的基本组成


#### 1.1.1 五大部分

1. 输入设备
	- 将信息转换成机器能识别的形式
2. 输出设备
	 - 将结果转换成人们熟悉的形式
3. 主存储器
	- 存放数据和程序
4. 运算器
	- 算术运算、逻辑运算
5. 控制器 
	- 指挥各部件，使程序运行

主机=主存储器+运算器+控制器

#### 1.1.2 冯诺依曼结构
- 首次提出“存储程序”概念
- 以运算器为中心
- 以存储器为中心

#### 1.1.3 现代计算机结构
- CPU = 运算器 + 控制器

### 1.2 计算机系统各硬件的基本组成

#### 1.2.1 主存

##### MAR (地址寄存器)

- *取件机器人，输入取件的地址，MAR去取件，放入MDR*
- 用于指明要读/写哪个存储单元。
- 位数反映存储单元数量，若MAR=4位，则有$2^4$个存储单元
##### MDR (数据寄存器)

- *传送带，接收MAR取出来的数据，等待其他人使用*
- 用于暂存要读/写的数。
- ==位数 = 存储字长 = 每个存储单元可以存放的bit数量==，若MDR=16位，则一个**字（word）** 的大小为16bit

##### 存储体


- 存储单元：每个存储单元存放一串二进制代码
- 存储字(word)：存储单元中二进制代码的组合
- 存储字长：存储单元中二进制代码的位数
- 存储元：即存储二进制的电子元件，每个存储元可存1bit


#### 1.2.2 运算器
##### ACC (累加计数器)

- 存放操作数、运算的结果
##### MQ (乘商寄存器)

- 进行乘、除法时用到，存放操作数、运算的结果
##### X (通用寄存器)

- 通用的操作数寄存器
- 存放操作数
- 理论上一个就够了，实际上可能存在多个


##### **ALU (算术逻辑单元)**

- 运算器的核心部件
- 通过内部复杂的电路实现实现各种算术运算、逻辑运算

#### 1.2.3 控制器
##### PC (程序计数器)

- 存放下一条指令的地址，有自动加一的功能


#####  IR (指令寄存器)

- 存放当前执行的指令

#####  **CU (控制单元)**

- 分析指令，给出控制信号

~~~mermaid
graph TD;
    A[根据PC的地址，取指令] --> B;
	B[将取出的指令存放IR] --> C[分析指令，给出控制信号];
~~~

#### 1.2.4 工作过程


- 初始：指令、数据存入主存，PC指向第一条指令
- 从主存中取指令放入IR、PC自动加1、CU分析指令、CU指挥其他部件执行指令

~~~mermaid

flowchart TD
    %% 三大功能模块定义
    subgraph CPU["CPU（蓝色边框）"]
        subgraph 运算器["运算器"]
            ACC((ACC))
            ALU[["ALU"]]
        end
        
        subgraph 控制器["控制器"]
            PC[["PC=0"]]
            IR[["IR"]]
            CU控制单元[["CU控制单元"]]
        end
    end

    subgraph 主存储器["主存储器（灰色边框）"]
        存储体[["存储体"]]
        MAR_M[["MAR"]]
        MDR_M[["MDR"]]
    end

    subgraph IO["I/O设备（绿色边框）"]
        输入设备[["键盘/传感器"]]
        输出设备[["显示器/打印机"]]
    end

    %% 数据流与控制流
    classDef cpu fill:#e6f3ff,stroke:#3399ff
    classDef mem fill:#f0f0f0,stroke:#666
    classDef io fill:#e8ffe6,stroke:#33cc33
    class CPU,主存储器,IO cpu,mem,io

    %% 取指令阶段（红色箭头）
    PC-->|"#1 地址0→"| MAR_M
    MAR_M-->|"#2 读地址0"| 存储体
    存储体-->|"#3 指令：00001 0000000101"| MDR_M
    MDR_M-->|"#4 指令→IR"| IR
    IR-->|"#5 解码操作码00001"| 控制单元

    %% 取操作数阶段（蓝色箭头）
    IR-->|"#6 地址码→MAR"| MAR_M
    MAR_M-->|"#7 读地址5"| 存储体
    存储体-->|"#8 数据a→"| MDR_M
    MDR_M-->|"#9 a→ACC"| ACC

    %% I/O关联（虚线表示潜在交互）
    IO-.->|"备用数据通道"| 存储体

~~~


~~~mermaid
flowchart TD
    %% 三大功能模块定义
    subgraph CPU["CPU"]
        subgraph 运算器["运算器"]
            ACC[["ACC"]]
            ALU[["ALU"]]
            MQ[["MQ"]]
            X[["X"]]
        end
        subgraph 控制器["控制器"]
            PC[["PC=0"]]
            IR[["IR"]]
            CU控制单元[["CU控制单元"]]
        end
    end
  

    subgraph 主存储器["主存储器"]
        存储体[["存储体"]]
        MAR_M[["MAR"]]
        MDR_M[["MDR"]]
    end

  

    subgraph IO["I/O设备"]
        输入设备[["键盘/传感器"]]
        输出设备[["显示器/打印机"]]
    end

  

    %% 数据流与控制流
    classDef cpu fill:#e6f3ff,stroke:#3399ff
    classDef mem fill:#f0f0f0,stroke:#666
    classDef io fill:#e8ffe6,stroke:#33cc33
    class CPU,主存储器,IO cpu,mem,io

  

    %% 取指令阶段

    PC-->|"#1 地址0→"| MAR_M
    MAR_M-->|"#2 读地址0"| 存储体
    存储体-->|"#3 指令：00001 0000000101"| MDR_M
    MDR_M-->|"#4 指令→IR"| IR
    IR-->|"#5 解码操作码00001"| CU控制单元
  

    %% 取操作数阶段（蓝色箭头）

    IR-->|"#6 地址码→MAR"| MAR_M
    MAR_M-->|"#7 读地址5"| 存储体
    存储体-->|"#8 数据a→"| MDR_M
    MDR_M-->|"#9 a→MQ"| MQ
    ACC-->|"#10 a→ACC"| X
    ALU-->|"#11 a→ACC"| ACC

    %% I/O关联（虚线表示潜在交互）
    IO-.->|"备用数据通道"| 存储体
~~~
