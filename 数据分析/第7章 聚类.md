# K-均值

![](attachment/Pasted%20image%2020250619235539.png)

## 1. 任意选择初始质心

虽说是任意，但是还是观察一下最后可能的质心在哪里。减少迭代次数

![](attachment/Pasted%20image%2020250619235710.png)

## 2. 计算距离并得出簇

在这里计算的是欧式距离，而不是它的平方和

![](attachment/Pasted%20image%2020250619235755.png)

![](attachment/Pasted%20image%2020250619235833.png)

## 3. 平方误差值sse

计算sse用于判断当前聚类效果好不好

![](attachment/Pasted%20image%2020250619235919.png)

## 4. 更新簇质心并迭代

![](attachment/Pasted%20image%2020250620000025.png)

![](attachment/Pasted%20image%2020250620000046.png)

![](attachment/Pasted%20image%2020250620000059.png)










# 课后习题-PAM (K-中心点)

![](attachment/Pasted%20image%2020250619235310.png)

以下是用 PAM 算法（Partitioning Around Medoids，围绕中心点划分聚类算法  ）解决该问题的详细步骤，考试答题时可按这样的逻辑梳理呈现：

### 一、PAM 算法原理简单回顾
PAM 算法属于划分式聚类算法，核心是先选定初始代表点（中心点，也叫 medoids ），然后通过不断替换中心点，计算聚类代价（通常是数据点到其所属类中心点的距离总和 ），找到使代价最小的聚类划分，最终确定簇的分布。步骤一般是：确定初始中心点→计算非中心点到中心点的距离并分配类别→尝试替换中心点，比较代价变化→迭代至最优。 

### 二、解题步骤（k=2，即划分成 2 个簇 ）
#### 1. 计算所有数据点两两之间的距离
这里是二维样本，用欧氏距离公式 $d(p,q)=\sqrt{(x_p - x_q)^2 + (y_p - y_q)^2}$ 计算，也可简化用平方欧氏距离（不影响聚类结果的相对关系 ），即 $d^2(p,q)=(x_p - x_q)^2 + (y_p - y_q)^2$ 。  
各点坐标：  
$o_1(0,2)$ 、$o_2(0,0)$ 、$o_3(1.5,0)$ 、$o_4(5,0)$ 、$o_5(5,2)$  

计算距离矩阵（只列关键计算，平方欧氏距离 ）：  
- $d^2(o_1,o_2)=(0 - 0)^2 + (2 - 0)^2 = 4$  
- $d^2(o_1,o_3)=(0 - 1.5)^2 + (2 - 0)^2 = 2.25 + 4 = 6.25$  
- $d^2(o_1,o_4)=(0 - 5)^2 + (2 - 0)^2 = 25 + 4 = 29$  
- $d^2(o_1,o_5)=(0 - 5)^2 + (2 - 2)^2 = 25 + 0 = 25$  
- $d^2(o_2,o_3)=(0 - 1.5)^2 + (0 - 0)^2 = 2.25$  
- $d^2(o_2,o_4)=(0 - 5)^2 + (0 - 0)^2 = 25$  
- $d^2(o_2,o_5)=(0 - 5)^2 + (0 - 2)^2 = 25 + 4 = 29$  
- $d^2(o_3,o_4)=(1.5 - 5)^2 + (0 - 0)^2 = 12.25$  
- $d^2(o_3,o_5)=(1.5 - 5)^2 + (0 - 2)^2 = 12.25 + 4 = 16.25$  
- $d^2(o_4,o_5)=(5 - 5)^2 + (0 - 2)^2 = 4$  


#### 2. 选择初始中心点（可随机选，也可按策略选，这里演示选两个不同点，比如先选 $o_1$ 和 $o_4$ ，后续会验证替换 ）
假设初始中心点集合 $M = \{o_1, o_4\}$  

#### 3. 分配非中心点到最近的中心点所在簇
- $o_2$ ：到 $o_1$ 距离平方是 4 ，到 $o_4$ 距离平方是 25 → 分配到 $o_1$ 所在簇（簇 1 ：$\{o_1, o_2\}$  ）  
- $o_3$ ：到 $o_1$ 距离平方 6.25 ，到 $o_4$ 距离平方 12.25 → 分配到 $o_1$ 所在簇（簇 1 变为 $\{o_1, o_2, o_3\}$  ）  
- $o_5$ ：到 $o_1$ 距离平方 25 ，到 $o_4$ 距离平方 4 → 分配到 $o_4$ 所在簇（簇 2 ：$\{o_4, o_5\}$  ）  

此时聚类划分：簇 1（$o_1, o_2, o_3$ ）、簇 2（$o_4, o_5$ ） ，计算当前总代价（各点到自身簇中心点距离平方和 ）：  
- 簇 1 中心点是 $o_1$ ，$o_2$ 到 $o_1$ 距离平方 4 ，$o_3$ 到 $o_1$ 距离平方 6.25 → 簇 1 代价：$4 + 6.25 = 10.25$  
- 簇 2 中心点是 $o_4$ ，$o_5$ 到 $o_4$ 距离平方 4 → 簇 2 代价：$4$  
- 总代价：$10.25 + 4 = 14.25$  


#### 4. 尝试替换中心点，优化聚类
PAM 算法要遍历“当前中心点集合替换一个点为非中心点”的所有可能，计算替换后的总代价，找更小的。  

**情况 1：替换 $o_1$ 为非中心点（$o_2$、$o_3$ ）**  
- 若替换成 $o_2$ ，新中心点 $M = \{o_2, o_4\}$  
  - 分配点：  
    $o_1$ 到 $o_2$ 距离平方 4 ，到 $o_4$ 距离平方 29 → 簇 1（$o_2$ 所在）：$\{o_1, o_2, o_3\}$（$o_3$ 到 $o_2$ 距离平方 2.25 小于到 $o_4$ 的 12.25  ）  
    簇 1 代价：$o_1$ 到 $o_2$（4） + $o_3$ 到 $o_2$（2.25） = 6.25  
    簇 2（$o_4$ 所在）：$\{o_4, o_5\}$ ，代价 4  
    总代价：$6.25 + 4 = 10.25$ ，比之前 14.25 小，记录。  

- 若替换成 $o_3$ ，新中心点 $M = \{o_3, o_4\}$  
  - 分配点：  
    $o_1$ 到 $o_3$ 距离平方 6.25 ，到 $o_4$ 距离平方 29 → 簇 1（$o_3$ 所在）：$\{o_1, o_2, o_3\}$（$o_2$ 到 $o_3$ 距离平方 2.25 小于到 $o_4$ 的 25  ）  
    簇 1 代价：$o_1$ 到 $o_3$（6.25） + $o_2$ 到 $o_3$（2.25） = 8.5  
    簇 2 代价 4  
    总代价：$8.5 + 4 = 12.5$ ，比 10.25 大，不优。  


**情况 2：替换 $o_4$ 为非中心点（$o_5$ ）**  
替换成 $o_5$ ，新中心点 $M = \{o_1, o_5\}$  
  - 分配点：  
    $o_2$ 到 $o_1$ 距离平方 4 ，到 $o_5$ 距离平方 29 → 簇 1（$o_1$ 所在）：$\{o_1, o_2, o_3\}$  
    $o_4$ 到 $o_5$ 距离平方 4 ，到 $o_1$ 距离平方 29 → 簇 2（$o_5$ 所在）：$\{o_4, o_5\}$  
  - 计算代价：  
    簇 1 代价同之前（10.25 ），簇 2 代价 4 ，总代价 14.25 ，不优。  


#### 5. 继续迭代，找更优替换（或确认当前最优 ）
上面替换 $o_1$ 为 $o_2$ 后总代价 10.25 更小，接着以新中心点 $M = \{o_2, o_4\}$ ，再次尝试替换其中一个中心点为非中心点（此时非中心点是 $o_1, o_3, o_5$  ），重复类似步骤，直到替换后总代价不再降低（即找到局部最优 ）。  

比如，对中心点 $M = \{o_2, o_4\}$ ，尝试替换 $o_2$ 为 $o_3$ ：  
新中心点 $M = \{o_3, o_4\}$ ，分配点后计算总代价 12.5 （前面算过 ），比 10.25 大；替换 $o_4$ 为 $o_5$ ，总代价 14.25 ，也大。再替换其他组合，发现总代价无法再降低。  

不过，还可以换初始中心点重新试，比如初始选 $o_2$ 和 $o_5$ ，看是否有更优结果。但通常经过几轮替换，会收敛到一个较优解。  

实际通过完整计算，会发现当中心点是 $o_2$ 和 $o_5$ 时：  
- $o_2$ 所在簇：$o_1$（到 $o_2$ 距离平方 4 ）、$o_2$、$o_3$（到 $o_2$ 距离平方 2.25 ），代价 $4 + 2.25 = 6.25$  
- $o_5$ 所在簇：$o_4$（到 $o_5$ 距离平方 4 ）、$o_5$ ，代价 4  
- 总代价 $6.25 + 4 = 10.25$ ，和之前替换后结果一致。  

再看另一种初始选点，比如 $o_2$ 和 $o_5$ 作为初始中心点，分配后：  
$o_1$ 到 $o_2$ 近（距离平方 4 ），$o_3$ 到 $o_2$ 近（距离平方 2.25 ），$o_4$ 到 $o_5$ 近（距离平方 4 ），其实和前面是同一聚类结构，只是中心点不同表述。  


### 三、最终聚类结果
经过 PAM 算法迭代优化，最终合理的聚类划分通常是：  
- 簇 1 ：$\{o_1, o_2, o_3\}$ （中心点可稳定在 $o_2$ 这类代表点 ）  
- 簇 2 ：$\{o_4, o_5\}$ （中心点可稳定在 $o_4$ 或 $o_5$ 这类代表点 ）  

从数据分布看，$o_1$、$o_2$、$o_3$ 在左侧区域（x 较小 ），$o_4$、$o_5$ 在右侧区域（x 较大 ），这样的聚类符合数据空间分布特征，总代价也相对最小。  

考试答题时，按上述步骤，先明确算法流程，计算距离、选初始中心点、分配类别、替换优化、迭代验证，最后得出聚类结果，就能完整解决 PAM 算法聚类问题啦，关键是把距离计算、替换逻辑和代价比较讲清楚 。 